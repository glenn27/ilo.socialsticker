<script src="https://connect.facebook.net/en_US/all.js"></script>
<div id="fb-root"></div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '1022633591082915',
      status     : true,
      cookie     : true,
      xfbml      : true,
      version    : 'v2.3'
    });
  }
  
  /*(function() {
    var e = document.createElement('script'); e.async = true;
    e.src = document.location.protocol +
    '//connect.facebook.net/en_US/all.js';
    document.getElementById('fb-root').appendChild(e);
  }());*/
    


  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>

<script type="text/javascript">

    
    
    $(document).ready(function(){
      $('input#share_fb').click(function(){
        var img_src= '';
        var page_title = $('#page_title').html();
        var link = $('#current_url').html();
        var selected = $("input[type='radio']:checked");
        var default_msg = '';
        if (selected.length > 0) {
          img_src = window.location.origin + selected.siblings('img').attr('src');
          default_msg = selected.siblings('span.sticker_default_msg').html();
        }
        var new_default_msg = prompt('Enter your message', default_msg);
        FB.ui(
          {
          method: 'feed',
          name: page_title,
          redirect_uri: link,
          link: link,
          picture: img_src,
          caption: new_default_msg,
          description: "",
          message: ''
          },
          function(response) {
              if (response && response.post_id) {
                  alert('Post was published.');
              } else {
                  alert('Post was not published.');
              }
          });
      });
      
      $("input[type='radio']").change(function(){
        default_msg = $(this).siblings('span.sticker_default_msg').html();
        twitter_href = $('a.twitter-share-button').attr('href');
        twitter_href += '&text='+default_msg;
        $('a.twitter-share-button').attr('href', twitter_href);
        
        
      });
      
      
      
      
    });
</script>

<!--<script>-->
<!--    !function(d,s,id){-->
<!--        var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';-->
<!--        if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);-->
<!--        }-->
<!--    }(document, 'script', 'twitter-wjs');-->
<!--  </script>-->


<div class="state-sign">
    <span id="page_title" tal:content="context/Title" style="display:none"></span>
    <span id="current_url" tal:content="context/absolute_url" style="display: none"></span>
    <div class="textwidget" tal:define="contents view/contents" tal:condition="contents">
        <form action=''>
 <ul class="small-block-grid-2 medium-block-grid-4 large-block-grid-6">
        <tal:entry tal:repeat="content contents">


            <li>
<input class= type='radio' tal:attributes="value content/UID" name='sticker'/>
                <img class="th" tal:attributes="src python: content.getPath() + '/images/sticker_image/mini'" class='sticker-image'/>
                <span class="sticker_default_msg" tal:content="python: content._unrestrictedGetObject().default_message" style="display: none"/>
                  </li>
        </tal:entry>
      </ul>
        </form>
        <input type='button' value='Share' id='share_fb' />
        <br/>
        <!--<a href="https://twitter.com/share" class="twitter-share-button" data-size="large" data-dnt="true">Tweet</a>-->
        <!--<a href="https://twitter.com/intent/tweet?text=Hello%20World" class="twitter-share-button" data-size="large" data-dnt="true">Tweet</a>-->
        <a tal:attributes="href string:https://twitter.com/intent/tweet?url=${context/absolute_url}" class="twitter-share-button" data-size="large" data-dnt="true" id="tweet-button" target="_blank">Tweet</a>
        <!--<a class="twitter-share-button"
           href="https://twitter.com/share"
           data-size="large"
           tal:attributes="data-url context/absolute_url"
           data-text=""
           target='iframe'
           >Tweet</a>-->
        
        
       
    </div>
</div>




